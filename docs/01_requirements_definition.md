# 要件定義書（再設計版）

最終更新: 2025-12-18

## 0. 概要

### 0.1 サービス名（仮）

- **「横断依頼を一本化し、協業で解決まで進められる」事業者ネットワーク型サービス**（名称未定）

### 0.2 背景 / 課題

- ターゲットは **起業家・事業者**。顧客（クライアント）の悩みは複合的になりやすい。
- 現状、事業者同士の横の繋がりはあるが、横断的な依頼が増えるほど
  - 案件の情報が分散しやすい
  - 誰が何を担当しているか不透明になりやすい
  - たらい回しが起きると取りこぼし・不信につながりやすい
- そこで「**フロント（窓口）は固定しつつ、裏側で協業して解決する**」ための仕組みが必要。

### 0.3 目的（ゴール）

- 顧客体験: **相談窓口を一本化**し、最短で解決に導く（たらい回し防止）
- 事業者体験: 横断依頼を **チームでさばける**（分担・進捗・成果物が見える）
- 事業成長: 紹介が回る仕組み（ポイント等）で **クロスセル / 協業** を促進

### 0.4 KPI（案）

- 相談→受注転換率
- 相談初回応答までの時間（SLA目標）
- 受注単価・LTV
- 紹介（おすすめ）経由の成約件数
- ポイント利用率（獲得→利用）
- 案件の滞留日数 / 放置率

---

## 1. 登場人物 / ロール設計（重要）

### 1.1 前提

- 「フロント事業者」「提供事業者」は固定ではなく、**メンバーは案件ごとにフロントにも提供にもなり得る**。
- よってシステム上は **ユーザ種別ではなく “案件ロール”** として扱う。

### 1.2 ロール（案件単位）

- **フロント（Front）**: 顧客窓口/案件オーナー。顧客に見える担当者。
- **提供（Provider）**: 役務提供（実作業）担当。
- **協力（Collaborator）**: 共同で情報共有・サポートするメンバー（必要に応じて）

### 1.3 顧客（Client）

- 顧客は
  - **(A) アカウント登録あり**（通知・情報提供・マイページ）
  - **(B) 登録なし（共有リンク閲覧のみ）**
    の両対応とする（Q-02回答反映）。

---

## 2. サービス体験（コンセプト）

### 2.1 たらい回し防止の基本方針

- 顧客にとっての窓口は基本「フロント」が維持される
- ただし必要に応じて **「提供者名の表示レベル」を案件/提案/商品ごとに選べる**（Q-04）

### 2.2 主要ユースケース

1. **営業資料（商品ページ）を共有して相談を獲得**
2. **おすすめ（楽天ROOM的）で紹介を積み上げ、提案に使う**
3. **横断依頼を案件化し、裏側でタスク分解してメンバーへ依頼**
4. **プラットフォーム内決済（＋現金などは例外的に手動）**
5. **入金確定でポイント付与、キャンセル時はポイント戻し（Q-07）**

---

## 3. 取引形態（契約主体とお金の流れ）

Q-03 / Q-11 を踏まえ、取引は最低でも2パターンを要件化する。

### 3.1 取引パターンA: 直接提供（Provider受注）

- 顧客は **提供者の商品** を購入する
- フロントは「紹介」または「窓口支援」として関与
- 契約主体: **提供者**
- ポイント: 提供者が設定したルールにより、紹介者（フロント等）へ付与

### 3.2 取引パターンB: フロント受注（ラッピング/丸ごと委託）

- フロントが **自分の商品としてラッピング** したものを顧客が購入
- フロントが提供者へ外注（下請け）する（支払いはプラットフォーム内/外どちらもあり得る）
- 契約主体: **フロント**
- ポイント: 取引設計により
  - (B-1) ポイントなし（フロントの売上でインセンティブ完結）
  - (B-2) 追加インセンティブとして付与（提供者がフロント向けにポイント設定可能）
    の両方に対応できるデータ設計とする（運用で選べる）

---

## 4. 機能要件（再整理）

### 4.1 オンボーディング（招待 + 審査）

- 参加は **招待制 + 審査**（Q-08）
- フロー例:
  1. 既存メンバーが招待コード発行 → 招待URL送付
  2. 新規ユーザ登録
  3. 審査フォーム入力（事業内容、実績、得意領域など）
  4. 運営承認でアクティブ化

#### 必須要件

- 招待コードの発行/失効
- 審査ステータス（未申請/審査中/承認/否認）
- 運営（管理者）画面で審査処理

---

### 4.2 プロフィール / ブランドカスタム

- メンバーは「営業資料」としても使える公開ページを持つ
- カスタムの自由度は高め（Q-12）

#### 必須要件

- 公開プロフィール（URLスラッグ）
- ロゴ/カバー画像/テーマカラー等の設定
- 連絡導線（問い合わせ/予約リンク等）

---

### 4.3 商品（サービス）管理（営業資料としての体裁）

- 自分の商品（サービス）を作成・公開できる
- 共有リンクとして営業資料にできる

#### 必須要件

- 商品の作成/編集/下書き/公開
- 料金タイプ: 単発/サブスク/成果報酬/見積（Q-09）
- PDF出力（優先度: 中。初期は共有リンクで代替可）
- 「ポイント設定（提供者が自由に設定）」
  - 商品ごとのポイント設定（固定 or 率）
  - パートナー別の上書き（任意・推奨）
    - フロントがどこまでやるかに応じて柔軟に調整できるため

---

### 4.4 おすすめ掲示（楽天ROOM的）

- 各メンバーが「おすすめボード（ルーム）」を作成し、商品を掲示できる
- 自分の商品 + パートナーの商品を混在できる

#### 必須要件

- ボード作成/編集/公開
- ボードに商品追加（コメント、並び替え、タグ）
- ボード/商品を共有リンクで配れる

---

### 4.5 紹介（アフィリエイト的）とポイント

- 紹介経由で購入されるとポイント獲得
- 現金化は不可（Q-06）
- 入金確定で付与、キャンセル時は取り消し/戻し（Q-07）

#### 必須要件（ルール）

- ポイントは「割引（値引き）」用途を中心に設計
- 付与タイミング: **決済成功（入金確定）**
- キャンセル/返金時: 付与済みポイントを **同額相当で戻し（マイナス計上/失効）**
- 不正対策: 付与・戻しは監査ログ必須

#### 推奨要件（運用に効く）

- 商品ごとに「ポイント利用上限（例: 最大30%）」を設定可能
- 1ポイント=1円相当などの換算レートを運営が設定（.env or 管理画面）

---

### 4.6 横断依頼の対応管理（案件管理）

- 案件フロー（Q-10）  
  相談 → ヒアリング → 提案 → 見積 → 受注 → 納品 → 請求 → 完了
- 案件内でタスク分解し、メンバーへ割り当てできる
- 顧客に見せる情報/見せない情報を制御できる（たらい回し防止）

#### 必須要件

- 相談（Inquiry）受け取りフォーム
- 相談→案件化（Deal化）
- 案件ステータス/期限/優先度
- タスク/担当/期限/成果物
- コメント（内部）と顧客共有メモ（外部）の分離
- 顧客共有リンク（ログイン不要で閲覧可 or ログインあり）

---

### 4.7 決済 / 受注管理

- 基本は **プラットフォーム内決済**（Q-05）
- 現金などは例外として手動入金登録を許容

#### 必須要件

- 注文（Order）/注文アイテム（OrderItem）
- 支払い（Payment）ステータス管理
- 決済プロバイダ連携（例: Stripe）
- 手動入金登録（現金）と監査ログ

---

### 4.8 通知

- 顧客登録ありの場合: メール/アプリ内通知
- 登録なしの場合: 共有リンク + 必要時メール通知（最低限）

---

### 4.9 管理者（運営）機能

- 招待・審査
- ユーザ停止/凍結
- 商品の非公開/通報対応
- 手動決済の承認
- ポイント調整（例外対応）

---

## 5. 非機能要件

### 5.1 セキュリティ

- 権限管理: 案件・注文・ポイントは関係者のみ閲覧
- 監査ログ: 決済ステータス変更、ポイント付与/取消、手動入金
- 個人情報保護: 顧客情報のアクセス制御、削除要請対応

### 5.2 可用性 / 性能

- 参加メンバー数: 100弱（Q-13）
- MVP想定: 中規模アクセス（営業資料閲覧は増えやすい）  
  → 公開ページはキャッシュ/画像最適化を優先

### 5.3 運用

- 利用規約/禁止事項/報酬（ポイント）規約整備
- トラブル時の問い合わせ導線

---

## 6. MVPスコープ（提案）

### MVP-1（最短で価値を出す）

- 招待+審査、プロフィール、商品ページ、ルーム、相談フォーム、案件管理（基本）、決済（Stripe）、ポイント付与/利用（シンプル）

### MVP-2（運用が回り出したら）

- パートナー別ポイントオファー
- 顧客ポータル（ログインあり）
- 分析（紹介→成約の可視化）
- サブスク/成果報酬の高度化
- ストアフロントの高度カスタム（セクション編集等）

---

## 7. 未決事項（要件として残す）

- **収益モデル（Q-01）**
  - 月額（メンバー課金）
  - 決済手数料（成約課金）
  - プレミアム機能課金（カスタム/分析/上位表示）
  - ハイブリッド
- プラットフォーム内決済における **提供者への分配方法（Stripe Connect等）**
  - MVPでは「支払い記録＋手動精算」でも開始可能（ただし運用負荷あり）
